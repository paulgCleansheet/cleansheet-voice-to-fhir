<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reference Architecture | Voice-to-FHIR</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Questrial&family=Barlow:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
        :root {
            --color-primary: #0066CC;
            --color-primary-dark: #004C99;
            --color-accent: #11304f;
            --color-success: #16a34a;
            --color-warning: #f59e0b;
            --color-error: #dc2626;
            --color-dark: #1a1a1a;
            --color-text: #333333;
            --color-text-secondary: #666666;
            --color-text-muted: #999999;
            --color-bg: #f5f5f7;
            --color-bg-light: #ffffff;
            --color-border: #e5e5e7;
            --color-code-bg: #1e293b;
            --font-ui: 'Questrial', sans-serif;
            --font-body: 'Barlow', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-body);
            font-weight: 300;
            background: var(--color-bg);
            color: var(--color-text);
            line-height: 1.6;
        }

        /* Navigation */
        .nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: var(--color-dark);
            color: white;
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-family: var(--font-ui);
            font-size: 1.25rem;
            text-decoration: none;
            color: white;
        }

        .nav-brand i {
            font-size: 1.5rem;
            color: var(--color-primary);
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .nav-links a {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            font-size: 0.875rem;
            transition: color 0.2s;
        }

        .nav-links a:hover {
            color: white;
        }

        .nav-links .btn-back {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--color-primary);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: 500;
        }

        .nav-links .btn-back:hover {
            background: var(--color-primary-dark);
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--color-dark) 0%, var(--color-accent) 100%);
            color: white;
            padding: 8rem 2rem 4rem;
            text-align: center;
        }

        .hero h1 {
            font-family: var(--font-ui);
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.25rem;
            opacity: 0.9;
            max-width: 700px;
            margin: 0 auto 2rem;
        }

        .hero-badges {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .hero-badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255,255,255,0.15);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.875rem;
        }

        .hero-badge i {
            font-size: 1rem;
        }

        /* Table of Contents */
        .toc {
            position: sticky;
            top: 80px;
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            max-height: calc(100vh - 100px);
            overflow-y: auto;
        }

        .toc h3 {
            font-family: var(--font-ui);
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--color-text-muted);
            margin-bottom: 1rem;
        }

        .toc ul {
            list-style: none;
        }

        .toc li {
            margin-bottom: 0.5rem;
        }

        .toc a {
            color: var(--color-text-secondary);
            text-decoration: none;
            font-size: 0.875rem;
            display: block;
            padding: 0.25rem 0;
            transition: color 0.2s, padding-left 0.2s;
        }

        .toc a:hover, .toc a.active {
            color: var(--color-primary);
            padding-left: 0.5rem;
        }

        /* Main Content Layout */
        .content-wrapper {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 2rem;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        @media (max-width: 1024px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
            .toc {
                position: static;
                max-height: none;
            }
        }

        .main-content {
            background: white;
            border-radius: 12px;
            padding: 3rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        /* Section Styles */
        section {
            margin-bottom: 4rem;
            scroll-margin-top: 100px;
        }

        section h2 {
            font-family: var(--font-ui);
            font-size: 2rem;
            color: var(--color-dark);
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 3px solid var(--color-primary);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        section h2 i {
            color: var(--color-primary);
        }

        section h3 {
            font-family: var(--font-ui);
            font-size: 1.35rem;
            color: var(--color-accent);
            margin: 2rem 0 1rem;
        }

        section h4 {
            font-family: var(--font-ui);
            font-size: 1.1rem;
            color: var(--color-text);
            margin: 1.5rem 0 0.75rem;
        }

        p {
            margin-bottom: 1rem;
        }

        /* Pipeline Diagram */
        .pipeline-diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0;
            padding: 2rem;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 12px;
            margin: 2rem 0;
            overflow-x: auto;
        }

        .pipeline-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            min-width: 140px;
        }

        .pipeline-icon {
            width: 80px;
            height: 80px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            margin-bottom: 0.75rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .pipeline-icon.voice { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }
        .pipeline-icon.medasr { background: linear-gradient(135deg, #10b981, #059669); }
        .pipeline-icon.medgemma { background: linear-gradient(135deg, #8b5cf6, #6d28d9); }
        .pipeline-icon.fhir { background: linear-gradient(135deg, #f59e0b, #d97706); }

        .pipeline-label {
            font-family: var(--font-ui);
            font-weight: 500;
            color: var(--color-dark);
            margin-bottom: 0.25rem;
        }

        .pipeline-sublabel {
            font-size: 0.75rem;
            color: var(--color-text-muted);
        }

        .pipeline-arrow {
            font-size: 1.5rem;
            color: var(--color-text-muted);
            margin: 0 0.5rem;
        }

        /* Architecture Cards */
        .arch-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .arch-cards-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        @media (max-width: 1100px) {
            .arch-cards-3 {
                grid-template-columns: 1fr;
            }
        }

        .arch-card {
            background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
            border: 1px solid var(--color-border);
            border-radius: 12px;
            padding: 1.5rem;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .arch-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.1);
        }

        .arch-card-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .arch-card-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .arch-card-icon.pattern-a { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }
        .arch-card-icon.pattern-b { background: linear-gradient(135deg, #8b5cf6, #6d28d9); }

        .arch-card h4 {
            font-family: var(--font-ui);
            margin: 0;
            color: var(--color-dark);
        }

        .arch-card-subtitle {
            font-size: 0.875rem;
            color: var(--color-text-muted);
        }

        .arch-card ul {
            list-style: none;
            margin: 1rem 0;
        }

        .arch-card li {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--color-border);
        }

        .arch-card li:last-child {
            border-bottom: none;
        }

        .arch-card li i {
            color: var(--color-success);
            margin-top: 0.15rem;
        }

        /* Data Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            font-size: 0.9rem;
        }

        .data-table th {
            background: var(--color-dark);
            color: white;
            font-family: var(--font-ui);
            font-weight: 400;
            text-align: left;
            padding: 1rem;
        }

        .data-table th:first-child {
            border-radius: 8px 0 0 0;
        }

        .data-table th:last-child {
            border-radius: 0 8px 0 0;
        }

        .data-table td {
            padding: 0.875rem 1rem;
            border-bottom: 1px solid var(--color-border);
        }

        .data-table tr:nth-child(even) {
            background: #f8fafc;
        }

        .data-table tr:last-child td:first-child {
            border-radius: 0 0 0 8px;
        }

        .data-table tr:last-child td:last-child {
            border-radius: 0 0 8px 0;
        }

        .data-table code {
            background: var(--color-bg);
            padding: 0.125rem 0.375rem;
            border-radius: 4px;
            font-family: var(--font-mono);
            font-size: 0.8rem;
        }

        /* Code Blocks */
        .code-block {
            background: var(--color-code-bg);
            border-radius: 12px;
            overflow: hidden;
            margin: 1.5rem 0;
        }

        .code-header {
            background: rgba(255,255,255,0.1);
            padding: 0.75rem 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .code-title {
            color: rgba(255,255,255,0.8);
            font-family: var(--font-mono);
            font-size: 0.8rem;
        }

        .code-copy {
            background: none;
            border: none;
            color: rgba(255,255,255,0.6);
            cursor: pointer;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .code-copy:hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }

        pre {
            padding: 1.25rem;
            overflow-x: auto;
            font-family: var(--font-mono);
            font-size: 0.8rem;
            line-height: 1.6;
            color: #e2e8f0;
        }

        pre .comment { color: #64748b; }
        pre .keyword { color: #f472b6; }
        pre .string { color: #a5f3fc; }
        pre .number { color: #fbbf24; }
        pre .arrow { color: #94a3b8; }
        pre .component { color: #a78bfa; }
        pre .highlight { color: #4ade80; }

        /* Info Boxes */
        .info-box {
            display: flex;
            gap: 1rem;
            padding: 1.25rem;
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        .info-box.tip {
            background: #ecfdf5;
            border-left: 4px solid var(--color-success);
        }

        .info-box.warning {
            background: #fffbeb;
            border-left: 4px solid var(--color-warning);
        }

        .info-box.note {
            background: #eff6ff;
            border-left: 4px solid var(--color-primary);
        }

        .info-box i {
            font-size: 1.25rem;
            flex-shrink: 0;
        }

        .info-box.tip i { color: var(--color-success); }
        .info-box.warning i { color: var(--color-warning); }
        .info-box.note i { color: var(--color-primary); }

        .info-box-content h4 {
            margin: 0 0 0.5rem;
            font-size: 1rem;
        }

        .info-box-content p {
            margin: 0;
            font-size: 0.9rem;
        }

        /* GPU Comparison */
        .gpu-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .gpu-card {
            background: white;
            border: 2px solid var(--color-border);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.2s;
        }

        .gpu-card.recommended {
            border-color: var(--color-primary);
            box-shadow: 0 4px 12px rgba(0, 102, 204, 0.15);
        }

        .gpu-card.recommended::before {
            content: 'Recommended';
            display: block;
            background: var(--color-primary);
            color: white;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            margin: -0.5rem auto 1rem;
            width: fit-content;
        }

        .gpu-card h5 {
            font-family: var(--font-ui);
            font-size: 1.25rem;
            color: var(--color-dark);
            margin-bottom: 0.5rem;
        }

        .gpu-card .vram {
            font-size: 2rem;
            font-weight: 600;
            color: var(--color-primary);
            margin: 0.5rem 0;
        }

        .gpu-card .spec {
            font-size: 0.8rem;
            color: var(--color-text-secondary);
            margin: 0.25rem 0;
        }

        .gpu-card .use-case {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--color-border);
            font-size: 0.875rem;
            color: var(--color-text);
        }

        /* Cost Summary */
        .cost-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .cost-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .cost-card-header {
            padding: 1.25rem;
            color: white;
        }

        .cost-card-header.pattern-a {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        }

        .cost-card-header.pattern-b {
            background: linear-gradient(135deg, #8b5cf6, #6d28d9);
        }

        .cost-card-header h4 {
            margin: 0;
            font-family: var(--font-ui);
        }

        .cost-card-header p {
            margin: 0.25rem 0 0;
            opacity: 0.9;
            font-size: 0.875rem;
        }

        .cost-card-body {
            padding: 1.25rem;
        }

        .cost-row {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px dashed var(--color-border);
        }

        .cost-row:last-child {
            border-bottom: none;
            font-weight: 600;
            padding-top: 1rem;
            margin-top: 0.5rem;
            border-top: 2px solid var(--color-border);
        }

        .cost-label {
            color: var(--color-text-secondary);
        }

        .cost-value {
            font-weight: 500;
        }

        /* Lists */
        .feature-list {
            list-style: none;
            margin: 1rem 0;
        }

        .feature-list li {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.75rem 0;
        }

        .feature-list li i {
            color: var(--color-success);
            font-size: 1.25rem;
            flex-shrink: 0;
        }

        /* Footer */
        footer {
            background: var(--color-dark);
            color: white;
            padding: 3rem 2rem;
            text-align: center;
            margin-top: 4rem;
        }

        footer p {
            opacity: 0.7;
            font-size: 0.875rem;
        }

        footer a {
            color: var(--color-primary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }
            .pipeline-diagram {
                flex-direction: column;
            }
            .pipeline-arrow {
                transform: rotate(90deg);
                margin: 0.5rem 0;
            }
            .main-content {
                padding: 1.5rem;
            }
            section h2 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <a href="../demo/index.html" class="nav-brand">
            <i class="ph ph-waveform"></i>
            Voice-to-FHIR
        </a>
        <div class="nav-links">
            <a href="#overview">Overview</a>
            <a href="#patterns">Patterns</a>
            <a href="#scaling">Scaling</a>
            <a href="#cost">Cost</a>
            <a href="../demo/index.html" class="btn-back">
                <i class="ph ph-arrow-left"></i>
                Back to Demo
            </a>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <h1>Reference Architecture</h1>
        <p>Deployment patterns for clinical voice documentation pipelines using MedASR and MedGemma</p>
        <div class="hero-badges">
            <span class="hero-badge">
                <i class="ph ph-shield-check"></i>
                HIPAA Compliant
            </span>
            <span class="hero-badge">
                <i class="ph ph-cpu"></i>
                GPU Accelerated
            </span>
            <span class="hero-badge">
                <i class="ph ph-plugs-connected"></i>
                FHIR R4 Native
            </span>
            <span class="hero-badge">
                <i class="ph ph-arrows-out"></i>
                Scalable
            </span>
        </div>
    </section>

    <!-- Main Content -->
    <div class="content-wrapper">
        <!-- Table of Contents -->
        <aside>
            <nav class="toc">
                <h3>Contents</h3>
                <ul>
                    <li><a href="#overview">Overview</a></li>
                    <li><a href="#components">Components</a></li>
                    <li><a href="#post-processing">Post-Processing</a></li>
                    <li><a href="#pattern-a">Pattern A: Small Practice</a></li>
                    <li><a href="#pattern-b">Pattern B: Enterprise</a></li>
                    <li><a href="#voice-capture">Voice Capture</a></li>
                    <li><a href="#ehr-integration">EHR Integration</a></li>
                    <li><a href="#scaling">Scaling Reference</a></li>
                    <li><a href="#high-availability">High Availability</a></li>
                    <li><a href="#security">Security</a></li>
                    <li><a href="#production">Production Considerations</a></li>
                    <li><a href="#cost">Cost Analysis</a></li>
                    <li><a href="#hardware">Hardware Specs</a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Overview Section -->
            <section id="overview">
                <h2><i class="ph ph-chart-line-up"></i> Overview</h2>
                <p>The voice-to-FHIR pipeline transforms spoken clinical documentation into structured FHIR resources through five stages:</p>

                <div class="pipeline-diagram">
                    <div class="pipeline-step">
                        <div class="pipeline-icon voice">
                            <i class="ph ph-microphone"></i>
                        </div>
                        <span class="pipeline-label">Voice Capture</span>
                        <span class="pipeline-sublabel">16kHz Audio</span>
                    </div>
                    <span class="pipeline-arrow"><i class="ph ph-arrow-right"></i></span>
                    <div class="pipeline-step">
                        <div class="pipeline-icon medasr">
                            <i class="ph ph-waveform"></i>
                        </div>
                        <span class="pipeline-label">MedASR</span>
                        <span class="pipeline-sublabel">Transcription</span>
                    </div>
                    <span class="pipeline-arrow"><i class="ph ph-arrow-right"></i></span>
                    <div class="pipeline-step">
                        <div class="pipeline-icon medgemma">
                            <i class="ph ph-brain"></i>
                        </div>
                        <span class="pipeline-label">MedGemma</span>
                        <span class="pipeline-sublabel">Extraction</span>
                    </div>
                    <span class="pipeline-arrow"><i class="ph ph-arrow-right"></i></span>
                    <div class="pipeline-step">
                        <div class="pipeline-icon" style="background: linear-gradient(135deg, #06b6d4, #0891b2);">
                            <i class="ph ph-magic-wand"></i>
                        </div>
                        <span class="pipeline-label">Post-Process</span>
                        <span class="pipeline-sublabel">ICD-10 / Cleanup</span>
                    </div>
                    <span class="pipeline-arrow"><i class="ph ph-arrow-right"></i></span>
                    <div class="pipeline-step">
                        <div class="pipeline-icon fhir">
                            <i class="ph ph-file-code"></i>
                        </div>
                        <span class="pipeline-label">FHIR R4</span>
                        <span class="pipeline-sublabel">Resources</span>
                    </div>
                </div>

                <h3>Design Principles</h3>
                <ul class="feature-list">
                    <li>
                        <i class="ph ph-check-circle"></i>
                        <div><strong>Edge capture, centralized processing</strong> - Voice captured at point of care, processed centrally</div>
                    </li>
                    <li>
                        <i class="ph ph-check-circle"></i>
                        <div><strong>Local transcription</strong> - MedASR runs on-premises to minimize PHI transmission</div>
                    </li>
                    <li>
                        <i class="ph ph-check-circle"></i>
                        <div><strong>Flexible extraction</strong> - MedGemma can be cloud or on-prem based on scale/compliance</div>
                    </li>
                    <li>
                        <i class="ph ph-check-circle"></i>
                        <div><strong>Hybrid AI + deterministic</strong> - Post-processing adds ICD-10 coding, deduplication, and validation</div>
                    </li>
                    <li>
                        <i class="ph ph-check-circle"></i>
                        <div><strong>Standard integration</strong> - FHIR R4 for EHR interoperability</div>
                    </li>
                </ul>
            </section>

            <!-- Components Section -->
            <section id="components">
                <h2><i class="ph ph-puzzle-piece"></i> Core Components</h2>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Component</th>
                            <th>Function</th>
                            <th>Resource Requirements</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Voice Gateway</strong></td>
                            <td>Receives audio from endpoints, routes to MedASR</td>
                            <td>2 vCPU, 4GB RAM</td>
                        </tr>
                        <tr>
                            <td><strong>MedASR Server</strong></td>
                            <td>Speech-to-text transcription</td>
                            <td>NVIDIA T4 GPU, 16GB VRAM</td>
                        </tr>
                        <tr>
                            <td><strong>MedGemma Server</strong></td>
                            <td>Clinical entity extraction</td>
                            <td>NVIDIA L4 GPU, 24GB VRAM</td>
                        </tr>
                        <tr>
                            <td><strong>Post-Processor</strong></td>
                            <td>ICD-10 lookup, deduplication, validation</td>
                            <td>1 vCPU, 512MB RAM (CPU only)</td>
                        </tr>
                        <tr>
                            <td><strong>FHIR Converter</strong></td>
                            <td>Transforms JSON to FHIR resources</td>
                            <td>2 vCPU, 4GB RAM</td>
                        </tr>
                        <tr>
                            <td><strong>Integration Hub</strong></td>
                            <td>Routes FHIR to EHR systems</td>
                            <td>4 vCPU, 8GB RAM</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- Post-Processing Section -->
            <section id="post-processing">
                <h2><i class="ph ph-magic-wand"></i> Post-Processing</h2>
                <p>AI outputs are enhanced by <strong>deterministic methods</strong> for coding accuracy, deduplication, and validation. This stage runs locally with zero API costs.</p>

                <div class="arch-cards arch-cards-3">
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon" style="background: linear-gradient(135deg, #06b6d4, #0891b2);">
                                <i class="ph ph-magnifying-glass"></i>
                            </div>
                            <div>
                                <h4>ICD-10 Lookup</h4>
                                <span class="arch-card-subtitle">Fuzzy matching against verified code database</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> Match conditions to ICD-10-CM codes</li>
                            <li><i class="ph ph-check"></i> Fuzzy matching handles transcription variations</li>
                            <li><i class="ph ph-check"></i> Local database - no network calls</li>
                            <li><i class="ph ph-check"></i> Confidence scoring for ambiguous matches</li>
                        </ul>
                    </div>
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon" style="background: linear-gradient(135deg, #8b5cf6, #6d28d9);">
                                <i class="ph ph-brackets-square"></i>
                            </div>
                            <div>
                                <h4>Transcript Markers</h4>
                                <span class="arch-card-subtitle">Extract from structured sections</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> Parse [SUBJECTIVE], [OBJECTIVE], [PLAN] sections</li>
                            <li><i class="ph ph-check"></i> Extract vitals from transcript (BP, HR, temp)</li>
                            <li><i class="ph ph-check"></i> Detect medication dosages via regex patterns</li>
                            <li><i class="ph ph-check"></i> Fallback for missed LLM extractions</li>
                        </ul>
                    </div>
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                                <i class="ph ph-check-circle"></i>
                            </div>
                            <div>
                                <h4>Validation & Cleanup</h4>
                                <span class="arch-card-subtitle">Filter placeholders, normalize values</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> Remove duplicate conditions and medications</li>
                            <li><i class="ph ph-check"></i> Filter placeholder values (e.g., "Name of medication")</li>
                            <li><i class="ph ph-check"></i> Normalize vital sign units</li>
                            <li><i class="ph ph-check"></i> Deduplicate blood pressure readings</li>
                        </ul>
                    </div>
                </div>

                <div class="info-box tip">
                    <i class="ph ph-lightbulb"></i>
                    <div class="info-box-content">
                        <h4>Hybrid AI + Deterministic Approach</h4>
                        <p>Combining MedGemma's semantic understanding with deterministic post-processing provides the best of both worlds: AI handles context and nuance, while rule-based systems ensure coding accuracy and catch edge cases. The post-processor is fast, reliable, and works offline with no API costs.</p>
                    </div>
                </div>

                <h3>Post-Processing Pipeline</h3>

                <div class="pipeline-flow-diagram">
                    <svg viewBox="0 0 700 620" xmlns="http://www.w3.org/2000/svg" style="width: 100%; max-width: 700px; height: auto;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
                            </marker>
                            <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#06b6d4;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#0891b2;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="grad2" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#6d28d9;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="grad3" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#10b981;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="grad4" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#f59e0b;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#d97706;stop-opacity:1" />
                            </linearGradient>
                        </defs>

                        <!-- Input node -->
                        <rect x="200" y="10" width="300" height="40" rx="20" fill="#1e293b"/>
                        <text x="350" y="36" text-anchor="middle" fill="white" font-family="'Barlow', sans-serif" font-size="14" font-weight="500">MedGemma Output (raw entities)</text>

                        <!-- Arrow 1 -->
                        <line x1="350" y1="50" x2="350" y2="75" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>

                        <!-- Stage 1: Transcript Marker Extraction -->
                        <rect x="50" y="80" width="600" height="95" rx="8" fill="url(#grad1)" opacity="0.15"/>
                        <rect x="50" y="80" width="600" height="95" rx="8" fill="none" stroke="url(#grad1)" stroke-width="2"/>
                        <text x="70" y="105" fill="#0891b2" font-family="'Questrial', sans-serif" font-size="14" font-weight="600">1. TRANSCRIPT MARKER EXTRACTION</text>
                        <text x="85" y="128" fill="#334155" font-family="'Barlow', sans-serif" font-size="12">• Parse [SUBJECTIVE], [OBJECTIVE], [ASSESSMENT], [PLAN] sections</text>
                        <text x="85" y="148" fill="#334155" font-family="'Barlow', sans-serif" font-size="12">• Extract vitals via regex (BP, HR, RR, Temp, SpO2)</text>
                        <text x="85" y="168" fill="#334155" font-family="'Barlow', sans-serif" font-size="12">• Detect medication orders in Plan section</text>

                        <!-- Arrow 2 -->
                        <line x1="350" y1="175" x2="350" y2="200" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>

                        <!-- Stage 2: ICD-10 Code Lookup -->
                        <rect x="50" y="205" width="600" height="95" rx="8" fill="url(#grad2)" opacity="0.15"/>
                        <rect x="50" y="205" width="600" height="95" rx="8" fill="none" stroke="url(#grad2)" stroke-width="2"/>
                        <text x="70" y="230" fill="#6d28d9" font-family="'Questrial', sans-serif" font-size="14" font-weight="600">2. ICD-10 CODE LOOKUP</text>
                        <text x="85" y="253" fill="#334155" font-family="'Barlow', sans-serif" font-size="12">• Fuzzy match condition names to ICD-10-CM database</text>
                        <text x="85" y="273" fill="#334155" font-family="'Barlow', sans-serif" font-size="12">• Handle common synonyms (HTN → I10, DM → E11.9)</text>
                        <text x="85" y="293" fill="#334155" font-family="'Barlow', sans-serif" font-size="12">• Score confidence for ambiguous matches</text>

                        <!-- Arrow 3 -->
                        <line x1="350" y1="300" x2="350" y2="325" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>

                        <!-- Stage 3: Validation & Deduplication -->
                        <rect x="50" y="330" width="600" height="105" rx="8" fill="url(#grad3)" opacity="0.15"/>
                        <rect x="50" y="330" width="600" height="105" rx="8" fill="none" stroke="url(#grad3)" stroke-width="2"/>
                        <text x="70" y="355" fill="#059669" font-family="'Questrial', sans-serif" font-size="14" font-weight="600">3. VALIDATION &amp; DEDUPLICATION</text>
                        <text x="85" y="378" fill="#334155" font-family="'Barlow', sans-serif" font-size="12">• Remove placeholder values ("Name of medication")</text>
                        <text x="85" y="398" fill="#334155" font-family="'Barlow', sans-serif" font-size="12">• Deduplicate conditions (case-insensitive)</text>
                        <text x="85" y="418" fill="#334155" font-family="'Barlow', sans-serif" font-size="12">• Remove duplicate BP readings, partial values</text>

                        <!-- Arrow 4 -->
                        <line x1="350" y1="435" x2="350" y2="460" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>

                        <!-- Stage 4: Unit Normalization -->
                        <rect x="50" y="465" width="600" height="75" rx="8" fill="url(#grad4)" opacity="0.15"/>
                        <rect x="50" y="465" width="600" height="75" rx="8" fill="none" stroke="url(#grad4)" stroke-width="2"/>
                        <text x="70" y="490" fill="#d97706" font-family="'Questrial', sans-serif" font-size="14" font-weight="600">4. UNIT NORMALIZATION</text>
                        <text x="85" y="513" fill="#334155" font-family="'Barlow', sans-serif" font-size="12">• BP → mmHg, HR → bpm, Temp → F/C, SpO2 → %</text>
                        <text x="85" y="533" fill="#334155" font-family="'Barlow', sans-serif" font-size="12">• Convert "null" strings to actual null; normalize relationships</text>

                        <!-- Arrow 5 -->
                        <line x1="350" y1="540" x2="350" y2="555" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>

                        <!-- Output node -->
                        <rect x="200" y="560" width="300" height="40" rx="20" fill="#16a34a"/>
                        <text x="350" y="586" text-anchor="middle" fill="white" font-family="'Barlow', sans-serif" font-size="14" font-weight="500">Cleaned Entities → FHIR</text>
                    </svg>
                </div>

                <style>
                    .pipeline-flow-diagram {
                        background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
                        border-radius: 12px;
                        padding: 1.5rem;
                        margin: 1.5rem 0;
                        display: flex;
                        justify-content: center;
                    }
                </style>

                <h3>Resource Requirements</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Component</th>
                            <th>CPU</th>
                            <th>Memory</th>
                            <th>Storage</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Post-Processor</strong></td>
                            <td>1 vCPU</td>
                            <td>512MB RAM</td>
                            <td>50MB</td>
                            <td>Pure Python, no GPU required</td>
                        </tr>
                        <tr>
                            <td><strong>ICD-10 Database</strong></td>
                            <td>-</td>
                            <td>~100MB</td>
                            <td>50MB</td>
                            <td>In-memory lookup table</td>
                        </tr>
                        <tr>
                            <td><strong>Regex Patterns</strong></td>
                            <td>-</td>
                            <td>&lt;1MB</td>
                            <td>-</td>
                            <td>Compiled at startup</td>
                        </tr>
                    </tbody>
                </table>

                <div class="info-box note">
                    <i class="ph ph-info"></i>
                    <div class="info-box-content">
                        <h4>Processing Time</h4>
                        <p>Post-processing adds &lt;50ms to the pipeline (typically 10-30ms). The entire post-processing stage runs on CPU and requires no GPU resources.</p>
                    </div>
                </div>

                <h3>Known Limitations</h3>
                <p>The following extraction limitations are known and should be accounted for in clinical validation workflows:</p>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Limitation</th>
                            <th>Workaround</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Medication Dosages</strong></td>
                            <td>Dosage extraction requires explicit dose statement in transcript (e.g., "metformin 1000 mg")</td>
                            <td>Clinician review for medications with null dose; prompt speakers to state dosages explicitly</td>
                        </tr>
                        <tr>
                            <td><strong>Duplicate Orders</strong></td>
                            <td>MedGemma may extract the same medication/procedure order multiple times from different transcript sections</td>
                            <td>Post-processor deduplication handles most cases; edge cases flagged for review</td>
                        </tr>
                        <tr>
                            <td><strong>Unit Normalization</strong></td>
                            <td>Vital sign units may be incorrectly assigned when multiple vitals mentioned in sequence</td>
                            <td>Type-specific unit validation (e.g., respiratory rate must be breaths/min, not °C)</td>
                        </tr>
                        <tr>
                            <td><strong>LLM Hallucination</strong></td>
                            <td>MedGemma may infer lab orders not explicitly stated (e.g., adding A1c for diabetic patients)</td>
                            <td>Cross-reference orders against transcript keywords; flag unmatched for review</td>
                        </tr>
                        <tr>
                            <td><strong>Referral Orders</strong></td>
                            <td>Referrals may be extracted with missing specialty when context is ambiguous</td>
                            <td>Filter referral orders with null/missing specialty field</td>
                        </tr>
                        <tr>
                            <td><strong>ICD-10 Ambiguity</strong></td>
                            <td>Fuzzy matching may return multiple candidate codes for vague condition descriptions</td>
                            <td>Confidence scoring surfaces ambiguous matches; clinician selects correct code</td>
                        </tr>
                    </tbody>
                </table>

                <div class="info-box warning">
                    <i class="ph ph-warning"></i>
                    <div class="info-box-content">
                        <h4>Clinical Validation Required</h4>
                        <p>All extracted entities should be reviewed by a clinician before EHR submission. The system is designed to accelerate documentation, not replace clinical judgment.</p>
                    </div>
                </div>
            </section>

            <!-- Pattern A Section -->
            <section id="pattern-a">
                <h2><i class="ph ph-buildings"></i> Pattern A: Small Practice</h2>
                <p><strong>Target:</strong> 1-20 providers, 50-200 encounters/day</p>

                <div class="arch-cards">
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon pattern-a">
                                <i class="ph ph-cloud"></i>
                            </div>
                            <div>
                                <h4>Hybrid Architecture</h4>
                                <span class="arch-card-subtitle">Local MedASR + Cloud MedGemma</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> Single GPU server on-premises for MedASR</li>
                            <li><i class="ph ph-check"></i> HuggingFace Endpoint for MedGemma (pay-per-use)</li>
                            <li><i class="ph ph-check"></i> PHI contained on-premises (only transcript leaves)</li>
                            <li><i class="ph ph-check"></i> Scale-to-zero for cost optimization</li>
                        </ul>
                    </div>
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon pattern-a">
                                <i class="ph ph-chart-bar"></i>
                            </div>
                            <div>
                                <h4>Capacity</h4>
                                <span class="arch-card-subtitle">Single T4 GPU</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> <strong>15-20</strong> transcriptions/hour</li>
                            <li><i class="ph ph-check"></i> <strong>5-8</strong> concurrent users (with queuing)</li>
                            <li><i class="ph ph-check"></i> <strong>120-160</strong> encounters/day (8-hour)</li>
                            <li><i class="ph ph-check"></i> Queue absorbs peak demand</li>
                        </ul>
                    </div>
                </div>

                <div class="diagram-container" style="background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); border-radius: 12px; padding: 24px; margin: 20px 0;">
                    <h4 style="margin: 0 0 16px 0; color: #334155; font-size: 14px; text-transform: uppercase; letter-spacing: 0.5px;">Pattern A Architecture</h4>
                    <svg viewBox="0 0 700 480" xmlns="http://www.w3.org/2000/svg" style="width: 100%; max-width: 700px; height: auto;">
                        <defs>
                            <linearGradient id="practiceGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#e0f2fe;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#bae6fd;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="serverGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#dbeafe;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#93c5fd;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="cloudGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#fef3c7;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#fde68a;stop-opacity:1" />
                            </linearGradient>
                        </defs>

                        <!-- Practice Network Container -->
                        <rect x="20" y="20" width="660" height="260" rx="12" fill="url(#practiceGrad)" stroke="#0284c7" stroke-width="2"/>
                        <text x="350" y="48" text-anchor="middle" font-family="Questrial, sans-serif" font-size="14" font-weight="600" fill="#0c4a6e">PRACTICE NETWORK</text>

                        <!-- Voice Capture Devices -->
                        <g transform="translate(100, 70)">
                            <rect x="0" y="0" width="500" height="50" rx="8" fill="white" stroke="#64748b" stroke-width="1.5"/>
                            <text x="250" y="20" text-anchor="middle" font-family="Questrial, sans-serif" font-size="12" font-weight="600" fill="#334155">Voice Capture</text>
                            <text x="250" y="38" text-anchor="middle" font-family="Barlow, sans-serif" font-size="11" fill="#64748b">iPhone, iPad, Windows, Voice Assistants</text>
                        </g>

                        <!-- Arrow down -->
                        <path d="M350 125 L350 145" stroke="#0284c7" stroke-width="2" marker-end="url(#arrowA)"/>
                        <defs><marker id="arrowA" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto"><path d="M0,0 L0,6 L9,3 z" fill="#0284c7"/></marker></defs>

                        <!-- Single GPU Server -->
                        <rect x="80" y="150" width="540" height="110" rx="10" fill="url(#serverGrad)" stroke="#2563eb" stroke-width="2"/>
                        <text x="350" y="175" text-anchor="middle" font-family="Questrial, sans-serif" font-size="13" font-weight="600" fill="#1e40af">SINGLE GPU SERVER</text>

                        <!-- Voice Gateway -->
                        <rect x="120" y="190" width="180" height="50" rx="6" fill="white" stroke="#3b82f6" stroke-width="1.5"/>
                        <text x="210" y="212" text-anchor="middle" font-family="Questrial, sans-serif" font-size="12" font-weight="600" fill="#1e40af">Voice Gateway</text>
                        <text x="210" y="230" text-anchor="middle" font-family="monospace" font-size="10" fill="#64748b">:8080</text>

                        <!-- Arrow right -->
                        <path d="M305 215 L375 215" stroke="#2563eb" stroke-width="2" marker-end="url(#arrowB)"/>
                        <defs><marker id="arrowB" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto"><path d="M0,0 L0,6 L9,3 z" fill="#2563eb"/></marker></defs>

                        <!-- MedASR -->
                        <rect x="380" y="190" width="200" height="50" rx="6" fill="white" stroke="#3b82f6" stroke-width="1.5"/>
                        <text x="480" y="212" text-anchor="middle" font-family="Questrial, sans-serif" font-size="12" font-weight="600" fill="#1e40af">MedASR</text>
                        <text x="480" y="230" text-anchor="middle" font-family="monospace" font-size="10" fill="#64748b">NVIDIA T4 :3002</text>

                        <!-- Arrow down to cloud -->
                        <path d="M350 285 L350 320" stroke="#0284c7" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowA)"/>
                        <text x="440" y="308" font-family="Barlow, sans-serif" font-size="10" fill="#64748b">Transcript (de-identified optional)</text>

                        <!-- Cloud Services Container -->
                        <rect x="20" y="330" width="660" height="130" rx="12" fill="url(#cloudGrad)" stroke="#d97706" stroke-width="2"/>
                        <text x="350" y="358" text-anchor="middle" font-family="Questrial, sans-serif" font-size="14" font-weight="600" fill="#92400e">CLOUD SERVICES</text>

                        <!-- HuggingFace Endpoint -->
                        <rect x="100" y="375" width="500" height="65" rx="8" fill="white" stroke="#f59e0b" stroke-width="1.5"/>
                        <text x="350" y="400" text-anchor="middle" font-family="Questrial, sans-serif" font-size="12" font-weight="600" fill="#92400e">HUGGINGFACE INFERENCE ENDPOINT</text>
                        <text x="350" y="420" text-anchor="middle" font-family="Barlow, sans-serif" font-size="11" fill="#64748b">MedGemma 4B (nvidia-l4-x1, scale-to-zero)</text>
                    </svg>
                </div>

                <div class="info-box note">
                    <i class="ph ph-info"></i>
                    <div class="info-box-content">
                        <h4>Cloud Considerations</h4>
                        <p>Requires BAA with HuggingFace for HIPAA compliance. Internet dependency for extraction. Consider de-identification pipeline for additional security layer.</p>
                    </div>
                </div>
            </section>

            <!-- Pattern B Section -->
            <section id="pattern-b">
                <h2><i class="ph ph-hospital"></i> Pattern B: Enterprise On-Premises</h2>
                <p><strong>Target:</strong> 50+ providers, 500+ encounters/day, hospital/health system</p>

                <div class="arch-cards">
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon pattern-b">
                                <i class="ph ph-hard-drives"></i>
                            </div>
                            <div>
                                <h4>Full On-Premises</h4>
                                <span class="arch-card-subtitle">Complete data sovereignty</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> MedASR cluster (3x T4 GPUs)</li>
                            <li><i class="ph ph-check"></i> MedGemma cluster (3x L4 GPUs)</li>
                            <li><i class="ph ph-check"></i> No cloud dependencies for PHI</li>
                            <li><i class="ph ph-check"></i> Kubernetes orchestration</li>
                        </ul>
                    </div>
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon pattern-b">
                                <i class="ph ph-chart-bar"></i>
                            </div>
                            <div>
                                <h4>Capacity</h4>
                                <span class="arch-card-subtitle">3-Node Clusters</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> <strong>60-80</strong> transcriptions/hour</li>
                            <li><i class="ph ph-check"></i> <strong>30-50</strong> concurrent users</li>
                            <li><i class="ph ph-check"></i> <strong>480-640</strong> encounters/day</li>
                            <li><i class="ph ph-check"></i> Peak handling: 100 concurrent</li>
                        </ul>
                    </div>
                </div>

                <div class="diagram-container" style="background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%); border-radius: 12px; padding: 24px; margin: 20px 0;">
                    <h4 style="margin: 0 0 16px 0; color: #581c87; font-size: 14px; text-transform: uppercase; letter-spacing: 0.5px;">Pattern B Architecture</h4>
                    <svg viewBox="0 0 700 700" xmlns="http://www.w3.org/2000/svg" style="width: 100%; max-width: 700px; height: auto;">
                        <defs>
                            <linearGradient id="hospitalGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#f3e8ff;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#e9d5ff;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="gatewayGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#dbeafe;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#93c5fd;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="asrGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#dcfce7;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#86efac;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="gemmaGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#fef3c7;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#fde68a;stop-opacity:1" />
                            </linearGradient>
                            <marker id="arrowC" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <path d="M0,0 L0,6 L9,3 z" fill="#7c3aed"/>
                            </marker>
                        </defs>

                        <!-- Hospital Network Container -->
                        <rect x="20" y="20" width="660" height="660" rx="12" fill="url(#hospitalGrad)" stroke="#7c3aed" stroke-width="2"/>
                        <text x="350" y="48" text-anchor="middle" font-family="Questrial, sans-serif" font-size="14" font-weight="600" fill="#581c87">HOSPITAL NETWORK</text>

                        <!-- Voice Capture Devices -->
                        <g transform="translate(60, 65)">
                            <rect x="0" y="0" width="580" height="50" rx="8" fill="white" stroke="#64748b" stroke-width="1.5"/>
                            <text x="290" y="20" text-anchor="middle" font-family="Questrial, sans-serif" font-size="12" font-weight="600" fill="#334155">Voice Capture</text>
                            <text x="290" y="38" text-anchor="middle" font-family="Barlow, sans-serif" font-size="11" fill="#64748b">Mobile, Nurse Stations, COWs, Dictation, Ambient Mics</text>
                        </g>

                        <!-- Arrow down -->
                        <path d="M350 120 L350 140" stroke="#7c3aed" stroke-width="2" marker-end="url(#arrowC)"/>

                        <!-- Voice Gateway Cluster -->
                        <rect x="60" y="145" width="580" height="100" rx="10" fill="url(#gatewayGrad)" stroke="#2563eb" stroke-width="2"/>
                        <text x="350" y="170" text-anchor="middle" font-family="Questrial, sans-serif" font-size="13" font-weight="600" fill="#1e40af">VOICE GATEWAY CLUSTER</text>
                        <text x="350" y="188" text-anchor="middle" font-family="Barlow, sans-serif" font-size="11" fill="#64748b">Load Balancer (F5/HAProxy)</text>

                        <!-- Gateway Nodes -->
                        <rect x="100" y="200" width="140" height="35" rx="5" fill="white" stroke="#3b82f6" stroke-width="1"/>
                        <text x="170" y="222" text-anchor="middle" font-family="Questrial, sans-serif" font-size="11" fill="#1e40af">Gateway 1</text>

                        <rect x="280" y="200" width="140" height="35" rx="5" fill="white" stroke="#3b82f6" stroke-width="1"/>
                        <text x="350" y="222" text-anchor="middle" font-family="Questrial, sans-serif" font-size="11" fill="#1e40af">Gateway 2</text>

                        <rect x="460" y="200" width="140" height="35" rx="5" fill="white" stroke="#3b82f6" stroke-width="1"/>
                        <text x="530" y="222" text-anchor="middle" font-family="Questrial, sans-serif" font-size="11" fill="#1e40af">Gateway 3</text>

                        <!-- Arrow down -->
                        <path d="M350 250 L350 270" stroke="#7c3aed" stroke-width="2" marker-end="url(#arrowC)"/>

                        <!-- MedASR GPU Cluster -->
                        <rect x="60" y="275" width="580" height="120" rx="10" fill="url(#asrGrad)" stroke="#16a34a" stroke-width="2"/>
                        <text x="350" y="300" text-anchor="middle" font-family="Questrial, sans-serif" font-size="13" font-weight="600" fill="#166534">MedASR GPU CLUSTER</text>
                        <text x="350" y="318" text-anchor="middle" font-family="Barlow, sans-serif" font-size="11" fill="#64748b">Message Queue (Redis/RabbitMQ)</text>

                        <!-- ASR Nodes -->
                        <rect x="100" y="330" width="140" height="50" rx="5" fill="white" stroke="#22c55e" stroke-width="1.5"/>
                        <text x="170" y="350" text-anchor="middle" font-family="Questrial, sans-serif" font-size="11" fill="#166534">MedASR Node 1</text>
                        <text x="170" y="368" text-anchor="middle" font-family="monospace" font-size="9" fill="#64748b">NVIDIA T4</text>

                        <rect x="280" y="330" width="140" height="50" rx="5" fill="white" stroke="#22c55e" stroke-width="1.5"/>
                        <text x="350" y="350" text-anchor="middle" font-family="Questrial, sans-serif" font-size="11" fill="#166534">MedASR Node 2</text>
                        <text x="350" y="368" text-anchor="middle" font-family="monospace" font-size="9" fill="#64748b">NVIDIA T4</text>

                        <rect x="460" y="330" width="140" height="50" rx="5" fill="white" stroke="#22c55e" stroke-width="1.5"/>
                        <text x="530" y="350" text-anchor="middle" font-family="Questrial, sans-serif" font-size="11" fill="#166534">MedASR Node 3</text>
                        <text x="530" y="368" text-anchor="middle" font-family="monospace" font-size="9" fill="#64748b">NVIDIA T4</text>

                        <!-- Arrow down -->
                        <path d="M350 400 L350 420" stroke="#7c3aed" stroke-width="2" marker-end="url(#arrowC)"/>

                        <!-- MedGemma GPU Cluster -->
                        <rect x="60" y="425" width="580" height="120" rx="10" fill="url(#gemmaGrad)" stroke="#d97706" stroke-width="2"/>
                        <text x="350" y="450" text-anchor="middle" font-family="Questrial, sans-serif" font-size="13" font-weight="600" fill="#92400e">MedGemma GPU CLUSTER</text>

                        <!-- Gemma Nodes -->
                        <rect x="100" y="465" width="140" height="50" rx="5" fill="white" stroke="#f59e0b" stroke-width="1.5"/>
                        <text x="170" y="485" text-anchor="middle" font-family="Questrial, sans-serif" font-size="11" fill="#92400e">MedGemma Node 1</text>
                        <text x="170" y="503" text-anchor="middle" font-family="monospace" font-size="9" fill="#64748b">NVIDIA L4</text>

                        <rect x="280" y="465" width="140" height="50" rx="5" fill="white" stroke="#f59e0b" stroke-width="1.5"/>
                        <text x="350" y="485" text-anchor="middle" font-family="Questrial, sans-serif" font-size="11" fill="#92400e">MedGemma Node 2</text>
                        <text x="350" y="503" text-anchor="middle" font-family="monospace" font-size="9" fill="#64748b">NVIDIA L4</text>

                        <rect x="460" y="465" width="140" height="50" rx="5" fill="white" stroke="#f59e0b" stroke-width="1.5"/>
                        <text x="530" y="485" text-anchor="middle" font-family="Questrial, sans-serif" font-size="11" fill="#92400e">MedGemma Node 3</text>
                        <text x="530" y="503" text-anchor="middle" font-family="monospace" font-size="9" fill="#64748b">NVIDIA L4</text>

                        <!-- Arrow down -->
                        <path d="M350 550 L350 575" stroke="#7c3aed" stroke-width="2" marker-end="url(#arrowC)"/>

                        <!-- EHR Integration Row -->
                        <g transform="translate(60, 580)">
                            <!-- FHIR Converter -->
                            <rect x="0" y="0" width="150" height="45" rx="6" fill="white" stroke="#7c3aed" stroke-width="1.5"/>
                            <text x="75" y="27" text-anchor="middle" font-family="Questrial, sans-serif" font-size="11" font-weight="600" fill="#581c87">FHIR Converter</text>

                            <!-- Arrow right -->
                            <path d="M155 22 L195 22" stroke="#7c3aed" stroke-width="2" marker-end="url(#arrowC)"/>

                            <!-- Integration Hub -->
                            <rect x="200" y="0" width="150" height="45" rx="6" fill="white" stroke="#7c3aed" stroke-width="1.5"/>
                            <text x="275" y="27" text-anchor="middle" font-family="Questrial, sans-serif" font-size="11" font-weight="600" fill="#581c87">Integration Hub</text>

                            <!-- Arrow right -->
                            <path d="M355 22 L395 22" stroke="#7c3aed" stroke-width="2" marker-end="url(#arrowC)"/>

                            <!-- EHR Systems -->
                            <rect x="400" y="0" width="180" height="45" rx="6" fill="#581c87" stroke="#581c87" stroke-width="1.5"/>
                            <text x="490" y="27" text-anchor="middle" font-family="Questrial, sans-serif" font-size="11" font-weight="600" fill="white">Epic / Cerner / MEDITECH</text>
                        </g>
                    </svg>
                </div>
            </section>

            <!-- Voice Capture Section -->
            <section id="voice-capture">
                <h2><i class="ph ph-microphone"></i> Voice Capture Endpoints</h2>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Device Type</th>
                            <th>Integration</th>
                            <th>Audio Format</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>iOS (iPhone/iPad)</td>
                            <td>Native app + WebSocket</td>
                            <td>16kHz PCM</td>
                            <td>Background recording support</td>
                        </tr>
                        <tr>
                            <td>Android</td>
                            <td>Native app + WebSocket</td>
                            <td>16kHz PCM</td>
                            <td>Foreground service required</td>
                        </tr>
                        <tr>
                            <td>Windows Workstation</td>
                            <td>Desktop client</td>
                            <td>16kHz PCM</td>
                            <td>Hotkey activation</td>
                        </tr>
                        <tr>
                            <td>Web Browser</td>
                            <td>WebRTC/MediaRecorder</td>
                            <td>16kHz WebM/Opus</td>
                            <td>Chrome, Edge, Firefox</td>
                        </tr>
                        <tr>
                            <td>Amazon Echo Show</td>
                            <td>Alexa Skill</td>
                            <td>16kHz PCM</td>
                            <td>"Alexa, start clinical note"</td>
                        </tr>
                        <tr>
                            <td>Dedicated Microphone</td>
                            <td>USB audio class</td>
                            <td>16kHz PCM</td>
                            <td>Dragon-compatible devices</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- EHR Integration Section -->
            <section id="ehr-integration">
                <h2><i class="ph ph-plugs-connected"></i> EHR Integration</h2>

                <h3>Integration Patterns</h3>
                <div class="arch-cards arch-cards-3">
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon pattern-a">
                                <i class="ph ph-file-code"></i>
                            </div>
                            <div>
                                <h4>FHIR R4 Native</h4>
                                <span class="arch-card-subtitle">Modern EHRs</span>
                            </div>
                        </div>
                        <p style="font-size: 0.9rem; color: var(--color-text-secondary);">
                            Direct FHIR Bundle submission to EHR FHIR Server. Supported by Epic (2020+), Cerner Millennium, Oracle Health.
                        </p>
                    </div>
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon pattern-b">
                                <i class="ph ph-file-doc"></i>
                            </div>
                            <div>
                                <h4>CDA Document</h4>
                                <span class="arch-card-subtitle">Universal Import</span>
                            </div>
                        </div>
                        <p style="font-size: 0.9rem; color: var(--color-text-secondary);">
                            FHIR-to-CDA conversion for document import. Standard C-CDA R2.1 supported by most EHRs.
                        </p>
                    </div>
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon pattern-a">
                                <i class="ph ph-plugs"></i>
                            </div>
                            <div>
                                <h4>HL7 v2</h4>
                                <span class="arch-card-subtitle">Legacy Systems</span>
                            </div>
                        </div>
                        <p style="font-size: 0.9rem; color: var(--color-text-secondary);">
                            ORU^R01 (results) and MDM^T02 (documents) messages via MLLP. For legacy EHRs and lab systems.
                        </p>
                    </div>
                </div>

                <h3>FHIR Resource Mapping</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Extracted Entity</th>
                            <th>FHIR Resource</th>
                            <th>Key Fields</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Conditions/Diagnoses</td>
                            <td><code>Condition</code></td>
                            <td>code (ICD-10), clinicalStatus</td>
                        </tr>
                        <tr>
                            <td>Medications</td>
                            <td><code>MedicationStatement</code></td>
                            <td>medicationCodeableConcept, dosage</td>
                        </tr>
                        <tr>
                            <td>Medication Orders</td>
                            <td><code>MedicationRequest</code></td>
                            <td>medicationCodeableConcept, dosageInstruction</td>
                        </tr>
                        <tr>
                            <td>Vitals</td>
                            <td><code>Observation</code></td>
                            <td>code (LOINC), value, effectiveDateTime</td>
                        </tr>
                        <tr>
                            <td>Lab Results</td>
                            <td><code>Observation</code></td>
                            <td>code (LOINC), value, interpretation</td>
                        </tr>
                        <tr>
                            <td>Lab Orders</td>
                            <td><code>ServiceRequest</code></td>
                            <td>code (LOINC), intent=order</td>
                        </tr>
                        <tr>
                            <td>Allergies</td>
                            <td><code>AllergyIntolerance</code></td>
                            <td>code, reaction, criticality</td>
                        </tr>
                        <tr>
                            <td>Family History</td>
                            <td><code>FamilyMemberHistory</code></td>
                            <td>relationship, condition</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- Scaling Section -->
            <section id="scaling">
                <h2><i class="ph ph-chart-line-up"></i> Scaling Reference</h2>

                <h3>GPU Performance Benchmarks</h3>

                <h4>MedASR on NVIDIA T4 (16GB)</h4>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Input Size</th>
                            <th>Latency (p50)</th>
                            <th>Latency (p99)</th>
                            <th>Throughput</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1 min audio</td>
                            <td>10-15s</td>
                            <td>22s</td>
                            <td>4-5/min</td>
                        </tr>
                        <tr>
                            <td>3 min audio</td>
                            <td>30-40s</td>
                            <td>60s</td>
                            <td>1.5-2/min</td>
                        </tr>
                        <tr>
                            <td>5 min audio</td>
                            <td>55-75s</td>
                            <td>110s</td>
                            <td>0.8-1/min</td>
                        </tr>
                        <tr>
                            <td>8 min audio</td>
                            <td>100-140s</td>
                            <td>200s</td>
                            <td>0.4-0.5/min</td>
                        </tr>
                    </tbody>
                </table>

                <div class="info-box tip">
                    <i class="ph ph-lightbulb"></i>
                    <div class="info-box-content">
                        <h4>T4 vs L4 for MedASR</h4>
                        <p>T4 is 15-20% slower than L4 for MedASR, but at 60% lower cost. Sufficient for most clinical workloads. Reserve L4 for MedGemma extraction.</p>
                    </div>
                </div>

                <h4>MedGemma 4B on NVIDIA L4 (24GB)</h4>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Input Size</th>
                            <th>Latency (p50)</th>
                            <th>Latency (p99)</th>
                            <th>Throughput</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>500 tokens</td>
                            <td>3-5s</td>
                            <td>8s</td>
                            <td>12-15/min</td>
                        </tr>
                        <tr>
                            <td>2000 tokens</td>
                            <td>10-15s</td>
                            <td>25s</td>
                            <td>4-5/min</td>
                        </tr>
                        <tr>
                            <td>8000 tokens</td>
                            <td>40-60s</td>
                            <td>90s</td>
                            <td>1/min</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Cluster Sizing Guide</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Daily Volume</th>
                            <th>MedASR Nodes (T4)</th>
                            <th>MedGemma Nodes (L4)</th>
                            <th>Total GPUs</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>50-100 encounters</td>
                            <td>1</td>
                            <td>1 (or cloud)</td>
                            <td>1-2</td>
                        </tr>
                        <tr>
                            <td>100-200 encounters</td>
                            <td>1</td>
                            <td>1</td>
                            <td>2</td>
                        </tr>
                        <tr>
                            <td>200-400 encounters</td>
                            <td>2</td>
                            <td>2</td>
                            <td>4</td>
                        </tr>
                        <tr>
                            <td>400-600 encounters</td>
                            <td>3</td>
                            <td>3</td>
                            <td>6</td>
                        </tr>
                        <tr>
                            <td>600-1000 encounters</td>
                            <td>4-5</td>
                            <td>4-5</td>
                            <td>8-10</td>
                        </tr>
                        <tr>
                            <td>1000+ encounters</td>
                            <td>6+</td>
                            <td>6+</td>
                            <td>12+</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- High Availability Section -->
            <section id="high-availability">
                <h2><i class="ph ph-shield-check"></i> High Availability</h2>

                <div class="arch-cards">
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon pattern-a">
                                <i class="ph ph-arrows-counter-clockwise"></i>
                            </div>
                            <div>
                                <h4>Pattern A: Warm Standby</h4>
                                <span class="arch-card-subtitle">Small Practice</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> Primary + Standby server</li>
                            <li><i class="ph ph-check"></i> DNS or floating IP failover</li>
                            <li><i class="ph ph-check"></i> <strong>RTO:</strong> 5-15 minutes</li>
                            <li><i class="ph ph-check"></i> <strong>RPO:</strong> 0 (stateless, reprocess from client buffer)</li>
                        </ul>
                    </div>
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon pattern-b">
                                <i class="ph ph-share-network"></i>
                            </div>
                            <div>
                                <h4>Pattern B: Active-Active</h4>
                                <span class="arch-card-subtitle">Enterprise</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> Load balancer with health checks</li>
                            <li><i class="ph ph-check"></i> Redis Sentinel for queue HA</li>
                            <li><i class="ph ph-check"></i> <strong>RTO:</strong> &lt; 30 seconds</li>
                            <li><i class="ph ph-check"></i> <strong>RPO:</strong> 0 (jobs in queue preserved)</li>
                        </ul>
                    </div>
                </div>

                <h3>Failure Scenarios</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Failure</th>
                            <th>Impact</th>
                            <th>Mitigation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Single GPU node</td>
                            <td>Reduced throughput</td>
                            <td>Queue redistributes to remaining nodes</td>
                        </tr>
                        <tr>
                            <td>Queue failure</td>
                            <td>Job loss</td>
                            <td>Redis Sentinel automatic failover</td>
                        </tr>
                        <tr>
                            <td>Gateway failure</td>
                            <td>Dropped connections</td>
                            <td>LB health checks, client reconnect</td>
                        </tr>
                        <tr>
                            <td>Full cluster</td>
                            <td>Service unavailable</td>
                            <td>DR site activation</td>
                        </tr>
                        <tr>
                            <td>Cloud endpoint (A)</td>
                            <td>Extraction unavailable</td>
                            <td>Queue locally, retry when restored</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- Security Section -->
            <section id="security">
                <h2><i class="ph ph-lock"></i> Security Considerations</h2>

                <h3>Data Classification</h3>
                <div class="arch-cards arch-cards-3">
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon" style="background: linear-gradient(135deg, #ef4444, #b91c1c);">
                                <i class="ph ph-warning"></i>
                            </div>
                            <div>
                                <h4>Zone 1: PHI</h4>
                                <span class="arch-card-subtitle">Protected Health Information</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> Raw audio (patient identifiers in speech)</li>
                            <li><i class="ph ph-check"></i> Transcripts (full clinical content)</li>
                            <li><i class="ph ph-check"></i> FHIR bundles (structured patient data)</li>
                        </ul>
                        <p style="font-size: 0.85rem; margin-top: 1rem; color: var(--color-text-secondary);">
                            <strong>Controls:</strong> AES-256 at rest, TLS 1.3 in transit, access logging
                        </p>
                    </div>
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                                <i class="ph ph-eye-slash"></i>
                            </div>
                            <div>
                                <h4>Zone 2: De-identified</h4>
                                <span class="arch-card-subtitle">Optional for cloud extraction</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> Transcripts with identifiers removed</li>
                            <li><i class="ph ph-check"></i> Dates shifted, ages generalized</li>
                            <li><i class="ph ph-check"></i> HIPAA Safe Harbor compliant</li>
                        </ul>
                    </div>
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon" style="background: linear-gradient(135deg, #22c55e, #16a34a);">
                                <i class="ph ph-check-circle"></i>
                            </div>
                            <div>
                                <h4>Zone 3: Operational</h4>
                                <span class="arch-card-subtitle">No PHI</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> Job metadata (IDs, timestamps, status)</li>
                            <li><i class="ph ph-check"></i> Performance metrics</li>
                            <li><i class="ph ph-check"></i> Error logs (sanitized)</li>
                        </ul>
                    </div>
                </div>

                <h3>Compliance Mapping</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Requirement</th>
                            <th>HIPAA</th>
                            <th>SOC2</th>
                            <th>FDA 510(k)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Encryption at rest</td>
                            <td>164.312(a)(2)(iv)</td>
                            <td>CC6.1</td>
                            <td>Cybersecurity</td>
                        </tr>
                        <tr>
                            <td>Encryption in transit</td>
                            <td>164.312(e)(1)</td>
                            <td>CC6.6</td>
                            <td>Cybersecurity</td>
                        </tr>
                        <tr>
                            <td>Access controls</td>
                            <td>164.312(a)(1)</td>
                            <td>CC6.1-6.3</td>
                            <td>Access control</td>
                        </tr>
                        <tr>
                            <td>Audit logging</td>
                            <td>164.312(b)</td>
                            <td>CC7.2</td>
                            <td>Audit trail</td>
                        </tr>
                        <tr>
                            <td>BAA with vendors</td>
                            <td>164.502(e)</td>
                            <td>N/A</td>
                            <td>N/A</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- Production Considerations Section -->
            <section id="production">
                <h2><i class="ph ph-rocket-launch"></i> Production Considerations</h2>

                <h3>Extraction Accuracy</h3>
                <p>Current extraction performance varies by entity type. These metrics are based on internal validation against annotated clinical transcripts:</p>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Entity Type</th>
                            <th>Precision</th>
                            <th>Recall</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Conditions</strong></td>
                            <td>~85%</td>
                            <td>~90%</td>
                            <td>ICD-10 lookup improves coding accuracy</td>
                        </tr>
                        <tr>
                            <td><strong>Medications (name)</strong></td>
                            <td>~90%</td>
                            <td>~85%</td>
                            <td>Strong on common medications</td>
                        </tr>
                        <tr>
                            <td><strong>Medications (dosage)</strong></td>
                            <td>~70%</td>
                            <td>~60%</td>
                            <td>Requires explicit statement in transcript</td>
                        </tr>
                        <tr>
                            <td><strong>Vitals</strong></td>
                            <td>~95%</td>
                            <td>~90%</td>
                            <td>Regex fallback catches most missed values</td>
                        </tr>
                        <tr>
                            <td><strong>Lab Orders</strong></td>
                            <td>~75%</td>
                            <td>~80%</td>
                            <td>Some hallucination of implied orders</td>
                        </tr>
                        <tr>
                            <td><strong>Allergies</strong></td>
                            <td>~85%</td>
                            <td>~75%</td>
                            <td>May miss allergies mentioned in passing</td>
                        </tr>
                    </tbody>
                </table>

                <div class="info-box note">
                    <i class="ph ph-info"></i>
                    <div class="info-box-content">
                        <h4>Accuracy Improvement</h4>
                        <p>Metrics improve significantly with structured dictation (using SOAP markers) and clear enunciation of clinical values. Training materials for optimal dictation practices are recommended for deployment.</p>
                    </div>
                </div>

                <h3>Recommended Validation Workflow</h3>
                <div class="arch-cards arch-cards-3">
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon" style="background: linear-gradient(135deg, #3b82f6, #1d4ed8);">
                                <i class="ph ph-eye"></i>
                            </div>
                            <div>
                                <h4>1. Review Flagged Items</h4>
                                <span class="arch-card-subtitle">Priority attention</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> Low-confidence ICD-10 matches</li>
                            <li><i class="ph ph-check"></i> Medications with null dosages</li>
                            <li><i class="ph ph-check"></i> Orders not found in transcript</li>
                        </ul>
                    </div>
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon" style="background: linear-gradient(135deg, #8b5cf6, #6d28d9);">
                                <i class="ph ph-list-checks"></i>
                            </div>
                            <div>
                                <h4>2. Verify Orders</h4>
                                <span class="arch-card-subtitle">Clinical safety</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> Confirm medication orders match intent</li>
                            <li><i class="ph ph-check"></i> Verify lab/imaging orders</li>
                            <li><i class="ph ph-check"></i> Check referral specialties</li>
                        </ul>
                    </div>
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                                <i class="ph ph-check-circle"></i>
                            </div>
                            <div>
                                <h4>3. Approve & Submit</h4>
                                <span class="arch-card-subtitle">EHR integration</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> Clinician attestation</li>
                            <li><i class="ph ph-check"></i> Digital signature</li>
                            <li><i class="ph ph-check"></i> FHIR bundle submission</li>
                        </ul>
                    </div>
                </div>

                <h3>Auditability Roadmap</h3>
                <p>For SOC2 Type 2 and FDA 510(k) cybersecurity compliance, structured audit logging is planned in three levels:</p>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Level</th>
                            <th>Scope</th>
                            <th>Features</th>
                            <th>Target</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="badge" style="background: var(--color-success); color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem; white-space: nowrap;">Level 1</span></td>
                            <td><strong>Minimal</strong></td>
                            <td>Extraction decision metadata in API response, timing breakdown per stage, pattern match logging</td>
                            <td>Current release</td>
                        </tr>
                        <tr>
                            <td><span class="badge" style="background: var(--color-warning); color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem; white-space: nowrap;">Level 2</span></td>
                            <td><strong>Production</strong></td>
                            <td>Structured JSON logging, Azure Log Analytics integration, session/recording IDs in all entries</td>
                            <td>Q2 2026</td>
                        </tr>
                        <tr>
                            <td><span class="badge" style="background: var(--color-error); color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem; white-space: nowrap;">Level 3</span></td>
                            <td><strong>Compliance-Grade</strong></td>
                            <td>Immutable audit log, before/after snapshots, cryptographic timestamps, 6-year retention (HIPAA)</td>
                            <td>Q4 2026</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Clinical Decision Support Scope</h3>
                <div class="info-box warning">
                    <i class="ph ph-warning"></i>
                    <div class="info-box-content">
                        <h4>Rudimentary First-Stage Processing</h4>
                        <p>The RxNorm verification, ICD-10 enrichment, and order-diagnosis linking features are <strong>demonstration-grade implementations</strong> intended for research and development. They are not substitutes for commercial clinical decision support systems.</p>
                    </div>
                </div>

                <p>Production environments should integrate with established clinical information systems:</p>

                <div class="arch-cards arch-cards-3">
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon" style="background: linear-gradient(135deg, #ef4444, #dc2626);">
                                <i class="ph ph-pill"></i>
                            </div>
                            <div>
                                <h4>Pharmacy Systems</h4>
                                <span class="arch-card-subtitle">Medication safety</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> Complete RxNorm/NDC databases</li>
                            <li><i class="ph ph-check"></i> Drug-drug interaction checking</li>
                            <li><i class="ph ph-check"></i> Allergy cross-referencing</li>
                            <li><i class="ph ph-check"></i> Dose range validation</li>
                        </ul>
                    </div>
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                                <i class="ph ph-code"></i>
                            </div>
                            <div>
                                <h4>Coding Services</h4>
                                <span class="arch-card-subtitle">Billing accuracy</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> Complete ICD-10-CM code sets</li>
                            <li><i class="ph ph-check"></i> Professional coder review</li>
                            <li><i class="ph ph-check"></i> CPT/HCPCS procedure coding</li>
                            <li><i class="ph ph-check"></i> Compliance validation</li>
                        </ul>
                    </div>
                    <div class="arch-card">
                        <div class="arch-card-header">
                            <div class="arch-card-icon" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
                                <i class="ph ph-first-aid-kit"></i>
                            </div>
                            <div>
                                <h4>Clinical CDS</h4>
                                <span class="arch-card-subtitle">Decision support</span>
                            </div>
                        </div>
                        <ul>
                            <li><i class="ph ph-check"></i> Contraindication alerts</li>
                            <li><i class="ph ph-check"></i> Renal/hepatic adjustments</li>
                            <li><i class="ph ph-check"></i> Age/weight-based dosing</li>
                            <li><i class="ph ph-check"></i> Clinical guidelines integration</li>
                        </ul>
                    </div>
                </div>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Feature</th>
                            <th>This Pipeline</th>
                            <th>Commercial CDS</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Medication Database</strong></td>
                            <td>~200 common medications</td>
                            <td>Complete RxNorm (~100,000+ concepts)</td>
                        </tr>
                        <tr>
                            <td><strong>ICD-10 Codes</strong></td>
                            <td>~500 common conditions</td>
                            <td>Complete ICD-10-CM (~70,000+ codes)</td>
                        </tr>
                        <tr>
                            <td><strong>Drug Interactions</strong></td>
                            <td>Not included</td>
                            <td>Comprehensive interaction databases</td>
                        </tr>
                        <tr>
                            <td><strong>Allergy Cross-Check</strong></td>
                            <td>Not included</td>
                            <td>Class-based allergy alerting</td>
                        </tr>
                        <tr>
                            <td><strong>Dosing Guidance</strong></td>
                            <td>Not included</td>
                            <td>Age/weight/renal function adjustments</td>
                        </tr>
                        <tr>
                            <td><strong>Clinical Guidelines</strong></td>
                            <td>Basic indication rules</td>
                            <td>Evidence-based protocol integration</td>
                        </tr>
                    </tbody>
                </table>

                <p style="margin-top: 1rem;"><strong>Recommended commercial CDS vendors:</strong> Wolters Kluwer (UpToDate, Lexicomp), Elsevier (ClinicalKey), First Databank, IBM Micromedex</p>

                <h3>Deployment Checklist</h3>
                <div class="info-box tip">
                    <i class="ph ph-clipboard-text"></i>
                    <div class="info-box-content">
                        <h4>Pre-Production Requirements</h4>
                        <ul style="margin: 0.5rem 0 0 1rem; list-style: disc;">
                            <li>BAA executed with cloud providers (HuggingFace for Pattern A)</li>
                            <li>SSL/TLS certificates configured (Azure-managed recommended)</li>
                            <li>Audit logging enabled and verified</li>
                            <li>Backup and recovery procedures documented</li>
                            <li>Clinician training on validation workflow completed</li>
                            <li>EHR integration tested in sandbox environment</li>
                            <li>Incident response plan documented</li>
                            <li>PHI handling procedures reviewed with compliance team</li>
                            <li><strong>Commercial CDS integration planned for medication safety</strong></li>
                            <li><strong>Professional coding workflow established for billing</strong></li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Cost Section -->
            <section id="cost">
                <h2><i class="ph ph-currency-dollar"></i> Cost Analysis</h2>

                <div class="cost-summary">
                    <div class="cost-card">
                        <div class="cost-card-header pattern-a">
                            <h4>Pattern A: Small Practice</h4>
                            <p>1-20 providers</p>
                        </div>
                        <div class="cost-card-body">
                            <div class="cost-row">
                                <span class="cost-label">GPU Server (1x T4)</span>
                                <span class="cost-value">$5,000</span>
                            </div>
                            <div class="cost-row">
                                <span class="cost-label">Network/Infrastructure</span>
                                <span class="cost-value">$2,000</span>
                            </div>
                            <div class="cost-row">
                                <span class="cost-label">Monthly Operating</span>
                                <span class="cost-value">$325-625</span>
                            </div>
                            <div class="cost-row">
                                <span class="cost-label">3-Year TCO</span>
                                <span class="cost-value">$24,100</span>
                            </div>
                        </div>
                    </div>
                    <div class="cost-card">
                        <div class="cost-card-header pattern-b">
                            <h4>Pattern B: Enterprise</h4>
                            <p>50+ providers</p>
                        </div>
                        <div class="cost-card-body">
                            <div class="cost-row">
                                <span class="cost-label">MedASR Servers (3x T4)</span>
                                <span class="cost-value">$15,000</span>
                            </div>
                            <div class="cost-row">
                                <span class="cost-label">MedGemma Servers (3x L4)</span>
                                <span class="cost-value">$30,000</span>
                            </div>
                            <div class="cost-row">
                                <span class="cost-label">Infrastructure</span>
                                <span class="cost-value">$25,000</span>
                            </div>
                            <div class="cost-row">
                                <span class="cost-label">Monthly Operating</span>
                                <span class="cost-value">$800-1,300</span>
                            </div>
                            <div class="cost-row">
                                <span class="cost-label">3-Year TCO</span>
                                <span class="cost-value">$120,300</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="info-box warning">
                    <i class="ph ph-warning"></i>
                    <div class="info-box-content">
                        <h4>Cloud-Only Alternative</h4>
                        <p>Full cloud deployment costs $2,600-5,000/month ($136,800 3-year TCO). Cloud-only has lower capital but higher operating costs; breaks even with on-prem at ~3 years.</p>
                    </div>
                </div>
            </section>

            <!-- Hardware Section -->
            <section id="hardware">
                <h2><i class="ph ph-cpu"></i> Hardware Specifications</h2>

                <h3>GPU Comparison</h3>
                <div class="gpu-cards">
                    <div class="gpu-card recommended">
                        <h5>NVIDIA T4</h5>
                        <div class="vram">16GB</div>
                        <div class="spec">65 FP16 TFLOPS</div>
                        <div class="spec">70W TDP</div>
                        <div class="spec">~$1,000</div>
                        <div class="use-case"><strong>Best for:</strong> MedASR (cost-optimized)</div>
                    </div>
                    <div class="gpu-card recommended">
                        <h5>NVIDIA L4</h5>
                        <div class="vram">24GB</div>
                        <div class="spec">120 FP16 TFLOPS</div>
                        <div class="spec">72W TDP</div>
                        <div class="spec">~$2,500</div>
                        <div class="use-case"><strong>Best for:</strong> MedGemma 4B</div>
                    </div>
                    <div class="gpu-card">
                        <h5>NVIDIA A10</h5>
                        <div class="vram">24GB</div>
                        <div class="spec">125 FP16 TFLOPS</div>
                        <div class="spec">150W TDP</div>
                        <div class="spec">~$4,000</div>
                        <div class="use-case"><strong>Best for:</strong> Higher throughput</div>
                    </div>
                    <div class="gpu-card">
                        <h5>NVIDIA A100</h5>
                        <div class="vram">80GB</div>
                        <div class="spec">312 FP16 TFLOPS</div>
                        <div class="spec">300W TDP</div>
                        <div class="spec">~$15,000</div>
                        <div class="use-case"><strong>Best for:</strong> Maximum capacity</div>
                    </div>
                </div>

                <h3>Recommended Server Configurations</h3>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-title">Small Practice - MedASR Server (Pattern A)</span>
                    </div>
<pre>
<span class="component">Tower server with single-slot GPU support</span>
<span class="arrow">├──</span> <span class="keyword">CPU:</span> <span class="string">x86-64, 16+ cores (Xeon Silver class)</span>
<span class="arrow">├──</span> <span class="keyword">RAM:</span> <span class="string">32GB DDR5</span>
<span class="arrow">├──</span> <span class="keyword">GPU:</span> <span class="highlight">1x NVIDIA T4 16GB</span>
<span class="arrow">├──</span> <span class="keyword">Storage:</span> <span class="string">2x 480GB NVMe RAID 1</span>
<span class="arrow">├──</span> <span class="keyword">Network:</span> <span class="string">2x 1GbE</span>
<span class="arrow">└──</span> <span class="keyword">Power:</span> <span class="string">600W PSU</span>
</pre>
                </div>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-title">Enterprise MedGemma Node (Pattern B)</span>
                    </div>
<pre>
<span class="component">2U rack server with full-height GPU support</span>
<span class="arrow">├──</span> <span class="keyword">CPU:</span> <span class="string">x86-64, 32+ cores (Xeon Gold class)</span>
<span class="arrow">├──</span> <span class="keyword">RAM:</span> <span class="string">64GB DDR5</span>
<span class="arrow">├──</span> <span class="keyword">GPU:</span> <span class="highlight">1x NVIDIA L4 24GB</span>
<span class="arrow">├──</span> <span class="keyword">Storage:</span> <span class="string">2x 960GB NVMe RAID 1</span>
<span class="arrow">├──</span> <span class="keyword">Network:</span> <span class="string">2x 10GbE</span>
<span class="arrow">└──</span> <span class="keyword">Power:</span> <span class="string">2x 800W redundant PSU</span>
</pre>
                </div>
            </section>
        </main>
    </div>

    <!-- Footer -->
    <footer>
        <p>Voice-to-FHIR Reference Architecture | <a href="https://github.com/CleansheetLLC/cleansheet-voice-to-fhir">GitHub</a> | Last updated: January 2026</p>
    </footer>

    <script>
        // Smooth scroll for TOC links
        document.querySelectorAll('.toc a').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const target = document.querySelector(link.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });

        // Highlight active TOC item on scroll
        const sections = document.querySelectorAll('section[id]');
        const tocLinks = document.querySelectorAll('.toc a');

        function highlightTOC() {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 120;
                if (window.scrollY >= sectionTop) {
                    current = section.getAttribute('id');
                }
            });

            tocLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('active');
                }
            });
        }

        window.addEventListener('scroll', highlightTOC);
        highlightTOC();
    </script>
</body>
</html>
